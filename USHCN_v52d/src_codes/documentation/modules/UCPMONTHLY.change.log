---------------------------- Module UCPMONTHLY ------------------------------

c    Undocumented Changepoint Driver began as a duplicate of octpart.v5d
c      on 10 May 2004. This is the major work into Phase II of the Inhomogeneity
c      project for the USHCN.
c
c     Version    Date     Description
c
c    --------------------------- Official Version USHCNv2 ----------------------
c
c    (52d) v24a 03aug08  Minor change in debug output formats
c
c          v24  29jul08  Minor change to ADJ output
c
c    (52a) v23  21mar08  Added output for HOFN graphs via commline -H hyear
c                          with output to -O outdir
c
c    (52a) v22a 06apr07  Created 'g' output flag for UNSTBL segment to remove from
c                          fillin (shortest segment)
c                        Fixed bug that excluded stations < 24 years!
c
c    (v52) v22  05jan07  Made distinct output idents for CONSHF, UNSTBL, etc.
c
c          v20e 20dec06  No Meta loop /    Sig Loop
c    (51d 51e 51f)
c
c    (v51) v20d 20dec06  Use ONLY TPR0 adjustments in ESTAMT at NPASS
c                                  fixed sigtrnd := 0.0 in ESTAMT
c    (51a 51b 51c)          Meta loop / No Sig loop
c
c    (50s) v20c 18dec06  Remove "not sig" step again
c
c    (50r) v20b 18dec06  If a local trend is removed then remove med adj (sig or not)
c
c 51a(50q) v20a 18dec06   Added paired series positive correlation requirement
c
c v51(50p) v20  18dec06  Attempt to use a skewed interquartile sig test 1.5/1.0 
c                          Changed usage of ichgout as temporary for each pass
c                          Fixed metadata KEPT when not tested
c                          Reset lower chgpt to be evaluated
c                          Changed Not sig minsta from 2 to 3
c                          Restored "not sig" step
c
c 50f     v19f  13dec06   Estamt - reverted to 2 steps i.e. removed "not sig" 
c
c 50e(o)  v19e  12dec06   Estamt - removed "good neigh" pass for step 3
c                                 removed 10 yr restriction on trend est
c
c 50d     v19d  12dec06   reduced interquartile trim scale from 1.5 to 1.0 
c
c 50c     v19c  06dec06   Remove local trend & interim adj
c
c v50(n)  v19b  05dec06   nindx migrated to Restart journal
c                        mmts adjustments to monthly in an Annual run fixed
c
c 50a     (minslpseg=18)added step for not-significant chgpt removal before
c 50b     (minslpseg=36)      adjustment step
c
c      v19a    28nov06   correct for removal of UNSTBL changepoints
c
c      v19     12nov06   corrections from the evaluation process
c                         1) move up timeres setting for himth/lomth 
c
c      v18a3   02nov06   additions for evaluation - 
c                        1) added nhits to WM99 output in estamt
c                        2) added mmts dates for correction to read_hist
c
c      v18a2   02nov06   reset estamt npass=2
c
c      v18a1   26oct06   Set estamt npass=4 and uncommented attendant lines
c
c      v18a    20oct06   Expanded merge year range for configfilt conflation
c
c      v18     18oct06   Consolidated removal of chgpt logic in Estamt
c
c      v17j    17oct06   Modified chgpt adj zscore to min mly anom std
c                          dev(temp1,temp2) from std dev of diff series
c
c      v17i4   06oct06   Removed shock-and-recovery modification from 
c                          non-significant slopefail median decisions (ZERSLP) 
c
c      v17i3   05oct06   Moved shock-and-recovery mod to median pooled estimate
c                          for slopefail contributions
c
c      v17i2   04oct06   Remove LMQ SINE test......
c
c                        Current solution to the "shock-and-recovery"
c                          senarios that we first began to address in MAY06!
c                        06oct06 - corrected equation to:
c                          zzadj(j) = adj(j) - 0.5 * (trend(j) + trend(j+1))
c
c      v17i1   04oct06   TEST - Try the LMQ SINE test again
c
c      v17i    04oct06   reverted back to 17g - updated all of the small
c                          errors found in the interim 
c                          Retained sigtest in final adjustment (tchgpt>tcrit)
c
c      v17g2   03oct06   Added significance testing of Targ-Pair in final
c                          adjustment using tchgpt > tcrit from MINBIC(iopt=4)
c
c      v17g1   03oct06   Rewrote final adjustment for one pass that broke the
c                          series back into non-slope and slope-fail threads,
c                          lost total offset for entire series (dstep - dtrend)
c
c      v17h    02oct06   TEST - Added back LMQ SINE test
c
c      v17g    29sep06   Revert to 17e3 - and remove extreme slope test (i.e.
c                          allow all slopes) and fixed cleanup for non-slopefail
c
c      v17e4   28sep06   TEST - Removed significance testing for adjustments
c                     (take all estimates, no test for median other than zero)
c
c      v17e3   27sep06   Fixed final adj/slope loop cleanup for non-slopefail
c                          and removed a bunch of trimming for slopes
c                          and removed LMQ SINE test
c
c      v17e2   27sep06   Expanded the 1 and only pass to all MINBIC models
c
c      v17e1   26sep06   Retreat from 17f to remove all trimmed means in both
c                          amplitude and slopes BEFORE any significance testing
c                          in amplitude and slopes.
c
c      v17e    22sep06   Try adding back slpfail restrictions (i.e. 
c                        +/-0.09 degrees per month: 6 C/decade)
c
c      v17d    22sep06   Fix Tukey Median trim to +/-1.0 Inner-Quartile Range
c                          from Q1 and Q3 instead of +/-1.5 IQR from Median
c
c      v17c    22sep06   Resurrected ONLY TPR2 option for single pass
c
c      v17b    21sep06   Restricted number of adjustment passes from 5 to 1
c                        Modified Minbic option from ONLY TPR2 (6) to
c                        ALL MODELS (4) on the single pass
c                        Removed slpfail restriction
c
c      v17a    20sep06   Fixed problems with the pooled trim estimate
c                        and bypassed annual fitting for the unsupported
c                        metadata.
c
c      v17     14sep06   Attempt to deal with the annual periodicity in some
c                          of the paired difference segements in ESTAMT using
c                          the Levenberg-Marquardt optimizing fitting algorithm
c                          with the monthly function form:
c                           Y = (b1 + b2 * X) + b3 * sin(2pi/12 * (X - b4))
c
c      v16k    01sep06   All the following changes are in ESTAMT:
c                        1) Pool the chgpt before segment with the chgpt-1 after
c                          segment trends for the slope-fail adjustments.
c                        2) Shorten the station changepoint loop
c                        3) Remove artifacts of the Span Offset variation
c
c      v16j    31aug06   Reapply removal of average monthly temps from the 
c                          diff series BEFORE applying the undocumented
c                          changepoint tests (see setrnet)
c
c      v16i    23aug06   In the Estamt final IPASS looping - the test for 
c                          minimum number of neighs has been placed BEFORE
c                          the slope fail check
c                        Also, the minlen of difference series segments were
c                          fixed to IADJLEN (incorrectly was MINLENSHF)
c
c      v16h    15aug06   After a long absense - removed ANNUAL modifications
c
c      v16h.ann 27jun06  set up Dec,2000 as the "lock month" for 0.0 adjustment
c                          see LOCKMO is estamt
c                        !!!!!! BE AWARE - SETUP FOR ANNUAL !!!!!
c                        excessive slope threshold reduce to 1.5C/decade
c                          see slpmthmax at inhomog.parm.system.mthly.incl
c
c      v16g    14jun06   expand #passes in estamt from 2 (for testing) to 6
c                          (for production). Simplified dT-dS algorithm.
c
c      v16f    08jun06   implement the "delta Trend - delta Step" adjustment
c                          for NPASS in ESTAMT. This is fundamentally different
c                          than the chgpt adjustment because the trend is 
c                          considered as part of the change.
c
c      v16e    08jun06   fix ESTAMT median adjustment routine. The trimmed 
c                          median should be used.
c                        fix error in Slope Fail "lock down" setting so that 
c                          it can check segment 1. AND fix error in failtest.
c        NOTE: for testing while making verion 16f - skips NPASS in ESTAMT
c
c      v16d    07jun06   use slope failure amplitudes in estamt IFF the chgpt 
c                          adjustment is estimated (see v16c)
c
c      v16c    06jun06   backtracked to slopefail threshold of 1/2 paired slopes
c                        greater slpmthmax (instead of 1/3)
c
c      v16b    05jun06   changed assumption of "Diff domain" when MINBIC returns
c                        an SLR and TPR: to: assumption of "Same domain" unless
c                        and until an opposite sign TPR is returned.
c
c      v16a    02jun06   added 10 year limit to adjustment calculation to 
c                          reduce effects of non-stationarity of temp
c                        added "last pass" at minsta/minlen for skipping
c                          slope-fail (shock & recovery) segments AFTER all
c                          possible other segments are merged
c
c      v16     31may06   clamp down on "shock & recovery" segments by ignoring
c                          them in estamt and correcting past them
c                         1) added arrays to retain the entire network worth of
c                              adjustment information
c                         2) implemented multiple passes through the estamt
c                              adjustment estimation by starting with the 
c                              longest period w/highest number of neighbor
c                              comparisons. 
c                         3) refrained from stepping across segments that failed
c                              slope restrictions till the last pass.
c
c      v15h    30may06   expanded ndelete to represent the statest complementary
c                         test at the PAIRED station level to transfer info
c                         directly to the amplitude estimation routine
c
c      v15g    29may06   introduced nfail return from minbic for estamt segment
c                          removal (for estimation only - data carried through
c                          into adjusted series)
c
c      v15f    28may06   removing segment merging in ESTAMT step 2
c                          NOTE: minhits is changed from 5 to 2
c
c      v15e    26may06   1) added NULL domain to "do nothing" in the Interim
c                          chgpt when only straight lines are returned by MINBIC
c                          that is: the interim chgpts are removed, but no data
c                          is deleted (nor ndelete).
c                        2) removed segment merging in Combined Stat algorithm
c                        3) went back to MINBIC iopt=4 for ESTAMT step 2
c                              (estimating amplitude)
c
c      v15d    25may06   changed philosophy about management of chgpts in
c                          estamt for the ZERSHF & REMSHF events.
c                          Since it is very difficult to make decisions 
c                          on combining the difference paired results involving
c                          slope failure, best model but insignificant, and
c                          best model with significance for the same candidate.
c                          The changes are as follows:
c                          -------- before  ------  | ------- current -------
c                         1) list of offsets to form trimed mean:
c                          use sig & insig offsets  | only use sig offsets
c                         2) when the trimed mean includes 0 (ZERSHF)
c                          keep chgpt for brkslope  | remove as straight line
c                         3) after removing a ZERSHF or REMSHF chgpt
c                          proceed to earlier chgpt | redo previous chgpt
c
c      v15c    24may06   fixed statsubs to reinitialize rtraw difference series
c                          after stat tests and before minbic
c
c      v15b    16may06   expanded estamt to include the verification or removal
c                          of the unsupported metadata locations with full
c                          BIC model runs with slope/critvar tests (istep=1)
c                          Have to move the 4th filter (alignmoves) from the 
c                          confirmfilt routine to the estamt routine AFTER
c                          the ndelete > ndellim removal of temps
c
c      v15a    14may06   also added ndelete to remove
c                         data for the amplitude estimate but use all of the 
c                         data fields for the output (duly indicating those that
c                         failed the ndelete test). ndelete threshold is ndellim 
c
c      v15     13may06    may changes to keep minbic as the defining analysis
c                         tool for changepoints. 
c
c      v14d    11may06    changed minbic option to "2" (critvar test) for
c                           interim chgpt tests. Kept "4" (no critvar nor
c                           slope test) for estamt
c
c      v14c    10may06    expanded "interim" chgpts idea using 
c                          1) if chgpts have same sign, pick best
c                          2) else remove interim chgpts & data in paired diff
c                                then recalc minbic to earliest chgpt
c
c      v14b    09may06    added ndelete to reinforce QC
c
c      v14a    09may06    removed slope/critical value BIC test from the 
c                         amplitude estimation. Pass all estimates back.
c
c      v14     06may06    realized estamt uses minbic to calculate offset 
c                         and t/ftests. !!!! QED: no need for method 3 !!!
c                         Changed array for chgpts from nchgpt to nhits
c                         removed division of nhits by ntech for thresholds.
c                         Added matrix printout after 4th filter(alignmoves)
c
c      v13     04may06   removed ntech dimension from nfound & nspan arrays,
c                        standardized point indices for first (target) and
c                        second (pair) stations - itarg,ipair, it2pair, ip2targ
c
c      v12a    21apr06   reworked statsubs for new philosophy
c
c      v11a    17apr06   Brought neglected annual timeres back to operational
c
c      v11     06apr06   For testing - changed slpmthmax == .015 (betav6)
c
c      v10     05apr06   For testing - reinstated ability to run each 
c                          technique (-T option)
c
c      v9f2    23mar06   revived completeness check for segments (betav6)
c
c      v9f1    23mar06   set minser back to 24 (betav6) instead of 12 (betav11)
c                          in inhomog.parm.system.incl
c
c      v9f     16feb06   rearranged minseg length in estamt to only minlenshf
c                          (03mar06 minlen == 18)
c
c      v9e     09feb06   added sum-square error return from MINBIC
c                          and fixed the UNSTBL at beg/end of series
c
c      v9d     22jan06   trivial change - added inqtype=5 to minbic in estamt
c
c      v9c     21jan06   moved ntest into the MLRTest to add only when a
c                          station has data
c
c      v9b     16jan06   rearranged UndocChgPt filter in confirmfilt. Now
c                          absorbs lesser hit months into closest - higher
c                          hit month. NOT highest amp in bracket.
c
c      v9a     15jan06   attempt to fix ntest wrt number of real tests for 
c                          the "neigh-cand" pair (vs the "cand-neigh" pair)
c                          Alternative is to add extra neighbor indices to
c                          all the work arrays, and there is just not enough
c                          space nor time.
c
c      v9      13jan06   brought back model type for each chgpt from MLRTest
c                          in order to add a model based confirm filter
c
c      v8H     27dec05   for speed sake: set WM = 99 first loop
c
c      v8g     18nov05   FINAL ESTAMT BIC CALL:
c                        Good Neigh restricted to pairs with adj > inner quart
c                        and segments > minlenshf (the know chgpts tests)
c
c      v8f     11oct05   remove slope restiction on BIC models 2,4,5 for a 
c                        more robust fit
c
c              29sep05   method = 3 uses the BIC only to find the best
c                        amplitude estimate, not to determine whether there
c                        is a chgpt.
c
c      v8e     28sep05(ii) method = 3 is removed from confirmfilt and goes
c                        directly to estamt (as in the beginning!)
c
c      v8d     28sep05   rearrange the use of the SHF - read the SHF
c                        along with the alignmoves at the beginning of
c                        main, right after reading the networks data.
c                        This usable segments in the data. Do not merge
c                        the metadata with the undoc-chgpts until the 
c                        confirmfilter stage so the pairwise can do its job.
c
c      v8c     22sep05   include data gaps > minlen as "raw" chgpts
c                        fixed UCHGPT filter for all hits (error @ 1914)
c
c      v8b     20sep05   rework the estamt code to determine whether a chgpt
c                          has enough significance and the final adjustment
c
c      v8      07sep05   Reworked statistical tests to strengthen independence
c                          and completeness:
c                          1) removed the Lag1 autocorr test
c                          2) added the Xioulan constant non-zero slope model
c                          3) removed the t-test, then
c                          4) added the more general Bayesian Info Criteria
c                               to test which model is "best" by estimating 
c                               the effect of the model's complexity
c
c      v7      09aug05   major work involving "fixing" a changepoint to a
c                          given stn/yr/mth no matter the missing data and
c                          pairwise compression. 
c
c                          nfound changed to char*1 & add nspan
c                          and consolidated many iy/im indices into imo
c
c      v6k     02aug05   If the data is missing at a station history "hit" 
c                          then shift the SHFHIT to the first month with data
c
c      v6j     22jul05   Correlation weighting for the adjustment estimate
c                        just does NOT work. Try the inner-quartile range
c
c      v6i     22jul05   Changed minlen from 5 to 18
c                        Upgraded the difference from full temperature to
c                          monthly anomalies (wrt whole series)
c                        Added a toggle to examine effect of correlation of
c                          monthly anomaly on the adjustment estimation
c
c      v6h     20jul05   Added completeness check for the adjustment estimation
c                        attempting to reign in the variation from pair to pair
c
c       -------------------- 2005_beta1 ---------------------
c       v6g    11jul05   At last filter - window set to smallest size (=5)
c
c       ------------------- 2005_alpha ----------------------
c       v6f    30jun05   Several minor modifications to optimize algorithm
c                        1) FINSHF filter changed from amp > std to
c                             t-test homog/inhomog
c                        2) method = 3 threshold set to 1
c                        3) corrected imo index conversion to/from mth-yr
c
c       v6e    26may05   test to reintroduce the t-test (method == 3) 
c
c       v6d    26may05   attempt to span window gap in estamp
c
c       v6c    26may05   retracted the 95% to 90% inclusion (these are what
c             the thresholds are based upon)
c
c     ucpmonthly.v6b 20may05:
c          1) SHFHIT (pass1-2nd) found did not use std. amp. - fixed
c          2) UCHGPT (pass1-3rd) filter 
c               Use the sorted amplitude to conflate UndocChg
c          2) Use 95% inclusion for the amp vs range spread - done
c          3) Add t-test (SHAP type) check for unresolved ChgPts at 
c               Pass2 before the amplitude filter
c          4) Currently - leave amplitude avg > std threshold as last filter
c               modify with weighting wrt 1diff corr
c
c     ucpmonthly.v6a 18may05 
c             adjusts offset amp wrt avg mthly stddev for width of merge window
c
c     ucpmonthly.v6 10may05:
c             Added output summary for each candidates estimate in "estamt".
c             This effectively removes method=3 which now has no calls to 
c             the MLRTest nor confirmfilt.
c
c     ucpmonthly.v5a 24mar05 
c             The clearing algorithm for the "highest erasure filter" in
c             confirmfilt did not remove all of the paired hit increments
c             because it back indexed from the highest hit station neighbor
c             list. Rewrote to look at all of the neighbors of all the 
c             stations, because station(2) may be a neighbor to station(1),
c             but station(1) does not necessarily have to be a neighbor of
c             station(2)!
c
c             Also had to set the minimum location spread vs amplitude to
c             the minimum window size for the statistical tests. Any other
c             size amplitude will "disappear" if there is any undoc or
c             not undoc changes within the minimum window. COULD SPAN THE
c             WINDOW!
c
c     ucpmonthly.v5 16mar05 Modified method 3 from the SHAP algorithm to 
c             merging in the metadata info into the suspect changepoint
c             array and employing the pairwise technique with the T-test.
c             Still holding onto method 2 (composite reference stations) as 
c             it may be useful at some future date.....
c
c     ucpmonthly.v4 16mar05 MLR Testseg vs SHAP Stnbn vs SHAP Mrgbn chgpt 
c             comparison. Shows that a new direction with the MLR Testseg
c             output gives BETTER results. This is a locked-in version with
c             all the associated models locked-in.
c
c     ucpmonthly.v3a 07mar05 Added results of the research into parameters for
c             pairwise (including confirm_filter.v2.f). As of UCPM3aM11bS41 and
c             its associated routines, there are no more confirmation input
c             parameters. For work related to the parameter study, see version:
c             UCPM3Lm2bM11aS41.
c
c     ucpmonthly.v3  07Feb05 Removed SHAP to speed up runs for pairwise 
c             questions. See references to stnhist. Added variable monthly
c             merge depending upon the estimated amplitude of the changepoint
c             (3 mar 05)
c
c     ucpmonthly.v2  02feb05 Removed all calls to the LV package(s). Mainly
c             removed the monthly estimation after the SHAP final call and the
c             entire multi-linear-regression options - not needed in pairwise
c             algorithm. 
c             Also, removed Durbin-Watson in favor of AutoLag1 only, because
c             the threshold can go down to lower obs and no need to defend 
c             whether using "gray" area between upper and lower bounds as in DW.
c
c     ucpmonthly.v2  18jan05 add SHAP history input (including capability for
c             input from MM's meta files)
c
c     ucpmonthly.v1o 10Dec04 tests the "high hit erasure" technique
c
c     ucpmonthly.v1n 5nov04 is the next generation using MONTHLY data after
c              Annual changepoints have been identified. Major changes include
c              expansion of the nfound array to include monthly + annual. And
c              a process toggle variable itimeres ( 0=annual;1=monthly )
c
c     ucpdriver.v1n 30Jul04 NWS48 change removed restriction on output for
c               No changepoints  
c               need output file whether chgpt found or not
c
c     ucpdriver.v1 10May04 - Testing code for the "looping" questions
c              v1 revives the iterative scheme and the SHAP adjustment
c
c     octpart.v5d 26apr04 - work around the 10 station limit for MM's
c              subnets
c
c     octpart.v5c2 9apr04 - pairwise with no loops and no SHAP
c
c     octpart.v5b2 5apr04 - Pairwise with no loops
c
c     octpart.v5b 05apr04 - Expanded nfound for hits to include the
c             "technique" dimension
c
c     octpart.v5a 12mar04 - Beginning of the formalized testing of the 
c             pairing algorithm, first by testing the individual ref/stat
c             combo's with each benchmark case.
c
c     octpart.v5 14jan03 - major re-examination of the import of the
c             separate methods (i.e. LV, PEEP, MD) as compared to the
c             separate of techniques to generate reference series (1stdiff,
c             LV station avg, MD z-score avg) and separate statistical tests
c             (Fmax, Tmax, Durbin-Watson) so that we now have the following
c             matrix:
c                           | Fmax  | Tmax | D-W  |
c                           -----------------------
c                   1stdiff |  PS   |  PT  |  PW  |
c                   LVref   |  LS   |  LT  |  LW  |
c                   MDref   |  MM   |  MD  |  MW  |
c
c             Note: PE is a conglomeration of (PS or PT) and MRPP
c                   this will not be addressed past version 'v4d'
c
c             Note: Lucie Vincent's algorithm implements the Durbin Watson 
c                test in two ways... 
c                1) LW uses the original code from L. Vincent - the
c                   reference series is generated as average anomaly
c                2) LV is developed from L.V.'s paper - the reference 
c                   is the independent stations compared with 
c                   Multi-linear Regression
c
c     v4dEP       09jan04 - parameter study on the PEEP method...
c             Original PEEP contained F(3,4),StuT,MRPP,dT(2,3)
c             Current PEEP inplementation Fmax,dT(avg)
c             Where F(3,4) is the F(3,n-4) thresholds
c                   Fmax are the Fmax thresholds
c                   StuT is the Student's T-test
c                   MRPP is the Mielke Ramdom Perturbation Test
c                   dT(2,3) is the generation of Ref_dT using 2-3 stations
c                   dT(avg) is Ref_dT from avg of all stations dT
c             Input parameters have been expanded to run tests separately
c                   or in combination.
c
c     octpart.v4d 03dec03 - lowlim = 2 for method = 1 worked for the
c             6 station benchmarks provided by MM. But, with a full
c             subnet of 20 stations, it provides far too many false
c             positives. Have returned to the idea of using a fraction
c             of the number of pair-wise "hits" to make a better 
c             measure. 
c
c            v4d also contains the first transfer and use of the 
c            METHOD type into the STATSUBS routine - just AUTOLAG currently
c
c     octpart.v4c 4nov03 - fixed bugs in random series (benchmark) code
c        for updates made since v4 began.
c
c     octpart.v4b 24oct03 - expanded Journal files to include saving and
c        checking of size parameters for state arrays that are written/read
c
c     octpart.v4a 18oct03 - incorporates LV's monthly adjustments into the
c        SHAP after the final annual adjustments are completed
c
c     octpart v4 15oct04 - ADDED RESTART ABILITY (Journal files)
c        implements the saving and reading of critical variables and arrays
c        used to restart the process at two points.....
c        METHOD_LOOP - entry point at the top of the loop defined as:
c             do while (method .lt. 3 .and. lht .ne. nht)
c          
c
c     octpart v3 26sep03 - NEXT GENERATION - IN PREPARATION FOR THE REAL WORLD
c        implements the expansion of the looping to include an entire network
c        includes first logic for the non-circularity of candidate subnets
c        (neighborhoods). Arrays and variables that drive this code are:
c
c        Pointers linking the stations and their data in each neighborhood
c          from /vapor5/USHCN/src/ushcn_corr_2000.v2.f
c        nindx(#subnets in network, #neigh in each subnet + circularity buffer) 
c
c     octpart v2b 17sep03 - calls mlrtest7, an abbreviated version of MM's mlr
c        which removes all vestiges of monthly processing and includes some 
c        subtle, but critical indexing changes for near perfect agreement with
c        MM's monthly and annual tests.
c
c     octpart v2a 16sep03 - added begin and end station input for rerunning for
c        recovery and special studies.
c
c     octpart v2 26aug03 - instituted the iexact and "last found" (lf??) arrays
c        because for_paper_I/case3b and caus_mest/3sigma got stuck in infinite loops.
c
c     octpart v1c as of 21 Aug 03 - consolidated and standardized debug output 
c             24 Jul 03 - First Concensus Version using the original 
c        Quadpart algorithms. Major changes in reponse to the Canadian Urban
c        question raised by RV from TK. Some reduction in the parameters 
c        passed and institution of a need-to-read array reduced execution
c        demands and defined the higher level looping better. 
c
c     octpart v1b 22 Jul 03 - Annual only (with month flags) defined
c        in readnet (read_write.f) - includes new versions of statistic
c        routine wrappers as well.....
c
c     octpart v1a uses the "pairing" method to find the largest chgpts, then
c        attempts the "greedy" method for finer resolution
c        (Note: original >unfinished< coding at quadpart.v2c.f)
c
c     octpart v1 16Jul 03 combines the classic statistical inhomog techniques
c        i.e. LV, EP, MD, and MM, with the mix&match reference series (Lucie's 
c        autolag and Peterson's firstdiff) with stat tests (SNIT and
c        TWOPHREG) suggested by mmenne, i.e. LS, LT, PS, and PT.
c
c     quadpart.v2b 10Jul03 implements a firmware switch (netloop) to  
c        enable(=1)/disable(=0) looping through the network to untangle 
c        chgpts in the neighborhood. Needed for benchmark statistics and
c        paper_I.
c
c     quadpart.v2a 26Jun03 Explores using only 1 network station ("pairing")
c
c     quadpart.v2 23Jun03  Explores the "round-robin" approach to determining
c         whether an inhomog is due to the candidate or network.....
c         unable to sort out attribution - abandoned approach
c
c     quadpart.v1 27May03  Added the two phase regression technique to the
c        MD suite for testing
c
c     tripart.v2 07may03   Pulled out LV's autolag subroutine so that major
c        changes can be made to the Test Statistic parsing. 
c
c     Tripart.v1 24dec02   After initial testing of the detection of the times
c       for inhomogeneity, this version 1) turns on output (for LV & PE) and
c       has modifications to run the GHCN through the PE code.
c
c     PROTO1            First program to test, head to head, the inhomogeneity 
c       techniques developed in the last 10 years since the original USHCN.
c
c     The first techniques to be tested will be:
c       PEEP: the first difference technique developed by Peterson & Easterling
c       LV: the lag correlation technique developed by Lucie Vincent
c       MLR: the maximum likelyhood ratio (formerly the standard normal homog)
c               technique developed by Alexxanderson and improved by Menne and Duchon
