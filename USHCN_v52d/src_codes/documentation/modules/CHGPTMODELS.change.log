 ---------------------------- Module CHGPTMODELS ------------------------------

c
c     version   date     description
c
c    --------------------------- Official Version USHCNv2 ----------------------
c
c      v6b     08jan07   last pass of ESTAMT uses ONLY TPR0 for best adj 
c                          consistency (iopt=6)
c
c    ------------------------ Internal Beta Version USHCNv2 --------------------
c    ---------------------------------- 21 Dec 2006 ----------------------------
c
c      v6a     19dec06   return TPR0 for any non-SLR fit for iopt=2
c
c      v6      05dec06   reinst minslpknt threshold count for slope segment
c
c      v5j     05oct06   redefined subroutine argument SLPQ to return the 
c                          kthline solutions for each segment (i.e. NOT 
c                          zeroed out for flat sloped MINQ model)
c
c      v5i     08jun06   added iopt=6 for last pass of ESTAMT to use ONLY TPR2
c
c      v5h     08jun06   modified iopt = 4/5 to skip TPR1 for consistency
c                          requirements for slopes between segments
c
c      v5g     07jun06   let full sloped model be returned with iopt = 4 even
c                          if slope fails slpmthmax (ifail returns failure #)
c
c      v5f     30may06   added nfail output for segments exceeding slope limits  
c
c      v5e     29may06   accounted for gap between sloped segments for 
c                        chgpts amplitude adjustment
c
c      v5d     28may06   separate out coincident and post threshold testing
c                          as options and printout
c
c      v5c     16may06   one more time..... bring the significance test and
c                          the slope test back up to the individual model tests
c
c      v5b     16may06   redefined iopt=4 to include Slope limit failure
c                          in this incarnation ONLY removes chgpt, NO data
c                          removed, NO ndelete increments (see estamt istep=2)
c                        added iopt=5 to test unsupport metadata chgpts
c                          (see estamt istep=1)
c
c      v5a     13may06   OK, try critical value test on ONLY minbic model. If
c                          fail, then fails all TPR models (no chgpt)
c
c      v5      12may06   Generation of the critical value tests
c                        MUST be preformed AT THE SAME TIME as the minbic
c                        that is, for each model.
c
c      v4g     11may06   Reinstate stat > critical threshold test in MINBIC
c                          using option == 2
c
c      v4f     10may06   Removed minslpknt for min-seg length, so that
c                        SSE and other model comparisons can be determined.
c
c      v4e     09may06   reinstated minslpknt for minimum segment length to 
c                        calculate slopes in SLR1, TPR1, TPR2, TPR3, TPR4
c
c      v4c     03may06   revisited F test rational - primarily degrees of
c                          freedom. Following definitions currently in effect:
c                        TPR0 - ttest - 3 dof
c                        TPR1, TRP3 & TPR4 - F1n3 - 4 dof
c                        TPR2 - F2n4 - 5 dof
c   -------------------------------------------------------------------------
c   |       NOTE: The BIC is the final arbiteur in deciding the data model  |
c   |         of a given changepoint. However, the variance test (Ttest or  |
c   |         Ftest) determines the significance. Therefore, AFTER the BIC  |
c   |         decides the data model, the variance test for the chosen      |
c   |         model keeps or drops the changepoint appropriately. (It seems |
c   |         the Kendall-Theil segment fit reduces the impact of outliers) |
c   -------------------------------------------------------------------------
c
c      v4b1    07apr06   Matt's basic principles--set mintest (a.k.a. minlen)=2
c
c      v4b     04apr06   fixed bug in twophreg1 - if input series(i) == missing
c                          then output stat(i) == missing
c
c      v4a     03mar06   stopping the "unconstrained experiment" (removing the
c                          changes between v3f & v3g). Adding back MINBIC for 
c                          methods 2 & 3. (NOTE: minlen == 18)
c
c      v4      10feb06   critical examination of missing in serial arrays
c                          particularly in SNITS, TWOPHREG, and TWOPHREG1
c                          MUST ensure correct execution!
c
c      v3i     09feb06   added sum-square error to MINBIC return
c
c      v3h     07feb06   no changes to internal code - just note slpmthmax
c                        changed in inhomog.parm.system.mthly.incl to .200
c                        (effectively the "bin"ed slope histogram limit)
c
c      v3g     22jan06   remove MINBIC from method=2, use T-test & F-test for
c                          method=3 and leave alone for estamt
c
c      v3f     22jan06   depends upon which stattest sends the data as to which
c                          models are tested (and not tested)
c                        TPR0 - no SLR0
c                        TPR1 & TPR2 - no SLR0 or SLR1
c
c      v3e     21jan06   added Slope Max Limit back to tests
c
c      v3d     19jan06   expand "bin"ed slopes technique to kendalltheil routine
c
c      v3c     18jan06   implement quicker methoed for finding median slope
c                        than sort-ascending by using "bin"ed slopes in kthline
c
c      v3b     15jan06   remodel minQ point as brkpt if within +-2 of brkpt est
c
c      v3a     11jan06   Calc SSE for breakpoint (offset=0) model at min off
c
c      v3      11jan06   Attempt to approximate breakpoint (no offset) models
c                          by iterating to a zero intercept
c
c      v2d     09jan06   UNarrange IQTYPES so that they are the order added
c                        major confusion in v2a rearrangement
c
c      v2c     06jan06   iopt = 3 added for zero offset segment iteration
c                        for models TPR1,2, and 4 (see v2a)
c
c      v2b     27dec05   for speed only - replaced the bubble-sort "sort1" 
c                          with the netlib "sortascending"
c
c      v2a     09dec05   yseg the TPR fits to include the "flat-to-slope"
c                          and "slope-to-flat" models as TPR1 & TPR2
c                          Move "constant-slope" and "full-tpr" to TPR3&4
c
c      v2      05dec05   split out the original FIT from the new Kendall-
c                          Theil routines (KTH) for TPR0,1,&2
c
c      v1e     28nov05   use the kendall-theil non-parametric regression
c                        to determine the slope and intercept to minimize
c                        impact of outliers
c
c      v1d     18nov05   separate out (in option = 2) the tests for known
c                        changepoint critical values are only used in the 
c                        last BIC pass 
c
c       v1c    13oct05   remove the max slope limit on SLR1
c                        remove the slope significance test on all slope models
c
c       v1b    29sep05   use the option param to determine whether BIC will
c                        return the best model or the best amplitude est.
 
